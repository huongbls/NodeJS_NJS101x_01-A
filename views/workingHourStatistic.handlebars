<div class="container">
  <h4>Thông tin giờ làm</h4>
  <a class="mt-3" href="/salaryStatistic">Thông tin bảng lương</a>
  <div class="float-right mb-3">
    <form action="/workingHourStatistic-search" method="GET">
      <label for="searchFromDate">Từ ngày:</label>
      <input type="date" name="searchFromDate" value="{{searchFromDate}}"/>
      <label for="searchToDate">Đến ngày:</label>
      <input type="date" name="searchToDate" /> 
      <button type="submit">Tra cứu</button>
    </form>
  </div>
  {{#if workingHourStatistic}}
    <table class="table table-bordered">
      <thead class="thead-light">
        <tr>
          <th>Ngày</th>
          <th>Nơi làm</th>
          <th>Giờ bắt đầu</th>
          <th>Giờ kết thúc</th>
          <th>Thời gian làm (hr)</th>
          <th>Nghỉ phép (hr)</th>
          <th>Tổng giờ làm (hr)(*)</th>
          <th>Overtime (hr)</th>
        </tr>
      </thead>
      <tbody>
        {{#each workingHourStatistic}}
          {{#if details}}
          {{#each details}}
            <tr>
              {{#ifCond @index '===' 0}}
              <td rowspan="{{../details.length}}">{{tolocaledatestring ../date}}</td>
              {{/ifCond}}
              <td>{{workplace}}</td>
              <td>{{getHours startTime}}:{{getMinutes startTime}}</td>
              {{#if endTime}}
                <td>{{getHours endTime}}:{{getMinutes endTime}}</td>
                <td>{{subStract endTime startTime}}</td>
              {{else}}
                <td>-</td>
                <td>-</td>
              {{/if}}
              {{#ifCond @index '===' 0}} 
              {{#if ../leaveHour}}
              <td rowspan="{{../details.length}}">{{../leaveHour}}</td>
              <td rowspan="{{../details.length}}">{{../totalHour}}</td>
              {{else}}
              <td rowspan="{{../details.length}}">-</td>
              <td rowspan="{{../details.length}}">{{../totalWorkingHour}}</td>
              {{/if}}
              <td rowspan="{{../details.length}}">{{../overTime}}</td>
              {{/ifCond}}
            </tr>
          {{/each}}
          {{else}}
          {{#if leaveHour}}
            <tr>
              <td>{{tolocaledatestring date}}</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>{{leaveHour}}</td>
              <td>{{totalHour}}</td>
              <td>-</td>
            </tr>
            {{/if}}
          {{/if}} 
        {{/each}}
      </tbody>
    </table>
    <p>(*) Tổng giờ làm trong ngày đã bao gồm giờ nghỉ phép</p>
  {{else}}
  {{#ifCond isNaNSearchFromDate '||' isNaNSearchToDate}}
  <p class="mt-5">Bạn chưa chọn ngày để tra cứu</p>
  {{else}}
    <p class="mt-5">Không có thông tin giờ làm từ ngày {{tolocaledatestring searchFromDate}} đến ngày {{tolocaledatestring searchToDate}}</p>
  {{/ifCond}}
  {{/if}}
  {{#if searchFromDate}}
    <a href="/workingHourStatistic">Quay lại Thông tin giờ làm</a>
  {{/if}}
  <br />
</div>

